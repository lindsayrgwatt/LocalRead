<% content_for :javascript_includes do %>
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?libraries=places&sensor=false"></script>
<% end %>

<% content_for :javascript do %>

    <script type="text/javascript">
        var input = document.getElementById('place_search');
        var options = {
            types: ['(regions)']
        };

        autocomplete = new google.maps.places.Autocomplete(input, options);

        google.maps.event.addListener(autocomplete, 'place_changed', function() {
            var place = autocomplete.getPlace();
            console.log( place );
            if (!place.geometry) {
                // Inform the user that a place was not found and return.
                return;
            }

            $("#subscriber_location").val( place.geometry.location.lat() + "," + place.geometry.location.lng() );
        });

        $(document).ready(function(){
            $("#subscriber_email").focus();
            $("#new_subscriber").validate();
        })

    </script>
<% end %>

<div class="page-container container-fluid">

  <!-- Page title -->
  <div class="row-fluid">
    <div class="page-title span12">
      <h1>The Local Read</h1>
    </div>
  </div>

  <!-- Page description -->
  <div class="row-fluid">
    <div class="page-description span6">
      <p>Get Blogger reviews of nearby restaurants delivered to your email once a week.</p>
    </div>
  </div>

  <!-- Subscription form -->
  <div class="row-fluid">
    <div class="subscription-form span12">
      <%= form_for @subscriber, :url => signup_path do |f| %>
          <% if @subscriber.errors.any? %>
              <% @subscriber.errors.full_messages.each do |msg| %>
                  <li><%= msg %></li>
              <% end %>
          <% end %>
          <p>
            <%= f.text_field :email, :placeholder => "Enter Your Email", :class=>"required email" %>
          </p>
          <p>
            <%= text_field :place, "search", :placeholder => "What City Do You Live In?" %>
            <%= f.hidden_field :location, :id=>"subscriber_location" %>
          </p>
          <%= f.submit :value => "Signup", :class=>"btn" %>
          <div class="success-message"></div>
          <div class="error-message"></div>
      <% end %>
    </div>
  </div>
</div>
