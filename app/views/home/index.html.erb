<% content_for :javascript_includes do %>
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?libraries=places&sensor=false"></script>
<% end %>

<% content_for :javascript do %>

    <script type="text/javascript">
        var input = document.getElementById('place_search');
        var options = {
            types: ['(regions)']
        };

        autocomplete = new google.maps.places.Autocomplete(input, options);

        google.maps.event.addListener(autocomplete, 'place_changed', function() {
            var place = autocomplete.getPlace();
            console.log( place );
            if (!place.geometry) {
                // Inform the user that a place was not found and return.
                return;
            }

            $("#subscriber_location").val( place.geometry.location.lat() + "," + place.geometry.location.lng() );
        });

        $(document).ready(function(){
            $("#subscriber_email").focus();
            $("#new_subscriber").validate();
        })

    </script>
<% end %>

<div class="row">

  <div class="span6 offset4">
    <h1>The Local Read</h1>
    <p>Signup now n' stuff</p>

    <%= form_for @subscriber, :url => signup_path do |f| %>
        <% if @subscriber.errors.any? %>
            <% @subscriber.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
            <% end %>
        <% end %>
        <p>
            <%= f.text_field :email, :placeholder => "Enter your email", :class=>"required email" %>
        </p>
        <p>
            <%= text_field :place, "search", :placeholder => "Enter your location" %>
            <%= f.hidden_field :location, :id=>"subscriber_location" %>
        </p>
        <%= f.submit :value => "Signup" %>

    <% end %>
  </div>
</div>
